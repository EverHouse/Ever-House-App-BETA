You have access to the repo. Fix the iPhone Add-to-Home-Screen (iOS PWA) “double-tap to click” issue across member/public UI, and harden session storage so DB issues don’t break startup.

DO NOT touch or request any secrets/keys. Only code changes.

PART A — Root fix for iOS PWA double-tap (hover-first-tap behavior)
1) In `src/index.css`, disable hover-only visual effects on touch devices.
These classes currently use `:hover` with transforms/visual changes and on iOS PWA the first tap often activates hover, the second tap triggers click:
- `.glass-card:hover`
- `.glass-panel:hover`
- `.glass-button:hover`
(and dark-mode variants)

Wrap ALL hover styles that change transform/scale/box-shadow/background in:

@media (hover: hover) and (pointer: fine) {
  /* move ALL your existing :hover rules for glass-card / glass-panel / glass-button here,
     including html.dark variants */
}

Then force-touch override:

@media (hover: none) {
  .glass-card:hover,
  .glass-panel:hover,
  .glass-button:hover {
    transform: none !important;
  }
}

Keep/retain `:active` styles (good for touch feedback).

PART B — Secondary fix: remove transform-based wrappers on touch devices (prevents iOS hit-testing bugs)
2) Add `src/hooks/useIsTouchDevice.ts`
- `detectTouchDevice()` returns true if ANY:
  - navigator.maxTouchPoints > 0
  - 'ontouchstart' in window
  - matchMedia('(pointer: coarse)').matches
  - matchMedia('(hover: none)').matches
- `useIsTouchDevice()` initializes from detectTouchDevice and updates on resize/orientationchange (guard matchMedia with try/catch)

3) Update `src/components/motion/DirectionalPageTransition.tsx`
- Replace pointer-only touch logic with `useIsTouchDevice()`.
- If `isTouchDevice` is true:
  - DO NOT use framer-motion transforms (no `motion.div` with x/y/transform).
  - Render a plain `<div>` wrapper only.
  - If you want animation, use opacity-only CSS (no transform).

4) Update `src/components/motion/SmoothScroll.tsx`
- Use the same `useIsTouchDevice()` for consistent behavior.

PART C — Make click targets robust (avoid form submits + touch conflicts)
5) Buttons must not accidentally submit forms:
- In `src/components/TabButton.tsx`, set `<button type="button" ...>`
- In `src/App.tsx` MemberBottomNav, set `type="button"` on nav buttons.

6) Remove touch handlers that can interfere with click:
- In MemberBottomNav, remove `onTouchStart/onTouchEnd` pressedIndex handlers.
- Keep navigation on `onClick`.
- If you still want pressed visuals, use Tailwind `active:` classes or pointer events (`onPointerDown/onPointerUp`), not touch events.

7) Ensure decorative overlays never intercept taps:
- In MemberBottomNav, any absolutely-positioned decorative/highlight element must include `pointer-events-none`.

PART D — Harden Replit auth session store (DB issues should not crash/hang startup)
File: `server/replit_integrations/auth/replitAuth.ts`

Goal: if `DATABASE_URL` is missing/unreachable OR the session table is missing, the server still starts and the app still runs (sessions degrade gracefully).

8) Lazy init Postgres session store:
- Do NOT create Pool/store at module load.
- Only attempt Postgres store if BOTH `SESSION_SECRET` and `DATABASE_URL` exist.
- Wrap store creation in try/catch; on failure log a warning (no secret values) and fall back to MemoryStore.

9) Enable auto table creation for sessions:
- When creating connect-pg-simple store, set `createTableIfMissing: true`.

PART E — Verify (must be done)
10) Run:
- `npm run build`
- `npm run start`

11) Confirm on iPhone Add-to-Home-Screen (PWA):
- Single tap works everywhere (simple buttons, bottom nav, Book tabs, Wellness tabs, Events tabs)
- Staff portal still works
- No startup crashes; sessions degrade gracefully if DB is misconfigured

Return:
- Files changed
- What changed and why
- Confirmation that iOS PWA single-tap works after these changes
